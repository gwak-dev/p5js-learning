<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5.js ê²Œì„ ë§ˆìŠ¤í„°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/closebrackets.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary: #6366f1;
            --secondary: #f472b6;
            --accent: #fbbf24;
            --success: #10b981;
            --error: #ef4444;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --muted: #94a3b8;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--card);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
        }

        .stat { display: flex; align-items: center; gap: 5px; }
        .stat-icon { font-size: 1.2rem; }
        .stat-value { font-weight: 700; color: var(--accent); }

        /* Main Layout */
        .main {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Home Screen */
        .home { display: block; }
        .home.hidden { display: none; }

        .welcome {
            text-align: center;
            margin-bottom: 40px;
        }

        .welcome h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .welcome p {
            color: var(--muted);
        }

        .day-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .day-item {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .day-item:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .day-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .day-item.locked:hover {
            border-color: transparent;
            transform: none;
        }

        .day-item.completed {
            border-color: var(--success);
        }

        .day-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .day-info h3 { margin-bottom: 5px; }
        .day-info p { color: var(--muted); font-size: 0.9rem; }

        .day-progress {
            margin-left: auto;
            font-size: 0.85rem;
            color: var(--muted);
        }

        /* Lesson Screen */
        .lesson { display: none; }
        .lesson.active { display: block; }

        .lesson-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .back-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .lesson-title {
            flex: 1;
        }

        .lesson-title h2 {
            font-size: 1.3rem;
            margin-bottom: 3px;
        }

        .lesson-title p {
            color: var(--muted);
            font-size: 0.85rem;
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 30px;
        }

        .progress-steps {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .progress-step {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            transition: all 0.3s;
        }

        .progress-step.completed {
            background: var(--success);
        }

        .progress-step.current {
            background: var(--primary);
        }

        .progress-text {
            text-align: center;
            font-size: 0.85rem;
            color: var(--muted);
        }

        /* Content Card */
        .content-card {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .step-emoji {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 20px;
        }

        .step-title {
            font-size: 1.4rem;
            text-align: center;
            margin-bottom: 20px;
        }

        .step-content {
            line-height: 1.8;
            color: var(--muted);
        }

        .step-content p {
            margin-bottom: 15px;
        }

        .step-content strong {
            color: var(--text);
        }

        .highlight-box {
            background: rgba(99, 102, 241, 0.15);
            border-left: 4px solid var(--primary);
            padding: 15px 20px;
            border-radius: 0 12px 12px 0;
            margin: 20px 0;
        }

        .highlight-box.success {
            background: rgba(16, 185, 129, 0.15);
            border-color: var(--success);
        }

        /* Code Editor with Preview */
        .code-preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 700px) {
            .code-preview-container {
                grid-template-columns: 1fr;
            }
        }

        .code-section {
            margin: 0;
        }

        .code-label {
            font-size: 0.9rem;
            color: var(--accent);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .code-editor {
            background: #0d1117;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .code-editor.focused {
            border-color: var(--primary);
        }

        .code-editor.correct {
            border-color: var(--success);
        }

        .code-editor.wrong {
            border-color: var(--error);
        }

        .code-input {
            width: 100%;
            min-height: 150px;
            background: transparent;
            border: none;
            color: #e6edf3;
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 14px;
            padding: 15px;
            resize: none;
            outline: none;
            line-height: 1.6;
        }

        .code-readonly {
            background: #0d1117;
            border-radius: 12px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 14px;
            color: #e6edf3;
            line-height: 1.8;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .code-result {
            background: #161b22;
            padding: 12px 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-family: 'Monaco', monospace;
            font-size: 13px;
            color: var(--muted);
            min-height: 40px;
        }

        .code-result.success { color: var(--success); }
        .code-result.error { color: var(--error); }

        /* Canvas Preview */
        .preview-section {
            background: #0d1117;
            border-radius: 12px;
            overflow: hidden;
        }

        .preview-label {
            font-size: 0.9rem;
            color: var(--success);
            padding: 10px 15px;
            background: #161b22;
            font-weight: 600;
        }

        .preview-canvas-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            background: #1a1a2e;
            min-height: 180px;
        }

        .preview-canvas-wrapper canvas {
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        /* Shape Demo */
        .shape-demo {
            margin: 20px 0;
        }

        .shape-demo-item {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .shape-demo-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .shape-demo-header h4 {
            font-size: 1.1rem;
            color: var(--accent);
        }

        .shape-demo-content {
            display: grid;
            grid-template-columns: 1fr 150px;
            gap: 15px;
            align-items: center;
        }

        @media (max-width: 500px) {
            .shape-demo-content {
                grid-template-columns: 1fr;
            }
        }

        .shape-code {
            background: #0d1117;
            padding: 12px 15px;
            border-radius: 8px;
            font-family: 'Monaco', monospace;
            font-size: 14px;
            color: #e6edf3;
        }

        .shape-canvas {
            display: flex;
            justify-content: center;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans KR', sans-serif;
            min-width: 120px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-check {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
        }

        .btn-run {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-retry {
            background: rgba(99, 102, 241, 0.3);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Quiz */
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .quiz-option {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .quiz-option:hover {
            border-color: var(--primary);
        }

        .quiz-option.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.2);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.2);
        }

        .quiz-option.wrong {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.2);
        }

        /* Reward Modal */
        .reward-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .reward-overlay.active {
            display: flex;
        }

        .reward-card {
            background: var(--card);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            border: 2px solid var(--accent);
        }

        .reward-emoji {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .reward-title {
            font-size: 1.8rem;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .reward-xp {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--success);
            margin: 20px 0;
        }

        /* Save Section */
        .save-section {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            margin-top: 30px;
        }

        .save-section h3 {
            font-size: 1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .save-btns {
            display: flex;
            gap: 10px;
        }

        .save-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s;
        }

        .save-btn.export {
            background: var(--success);
            color: white;
        }

        .save-btn.import {
            background: var(--primary);
            color: white;
        }

        .save-msg {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.85rem;
            display: none;
        }

        .save-msg.show {
            display: block;
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        /* Confetti */
        .confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Interactive Code Editor Styles */
        .interactive-editor {
            margin: 20px 0;
        }

        .editor-hint {
            color: var(--muted);
            font-size: 0.85rem;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        /* CodeMirror Custom Styles */
        .CodeMirror {
            height: auto;
            min-height: 120px;
            max-height: 300px;
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 14px;
            border-radius: 12px;
            padding: 5px 0;
        }

        .CodeMirror-scroll {
            min-height: 120px;
            max-height: 300px;
        }

        .code-editor .CodeMirror {
            border-radius: 12px 12px 0 0;
        }

        .code-editor.correct .CodeMirror {
            border: 2px solid var(--success);
        }

        .code-editor.wrong .CodeMirror {
            border: 2px solid var(--error);
        }

        .cm-wrapper {
            border-radius: 12px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">ğŸ® p5.js ê²Œì„ ë§ˆìŠ¤í„°</div>
        <div class="stats">
            <div class="stat">
                <span class="stat-icon">âš¡</span>
                <span class="stat-value" id="xp-display">0</span>
                <span>XP</span>
            </div>
            <div class="stat">
                <span class="stat-icon">ğŸ”¥</span>
                <span class="stat-value" id="streak-display">0</span>
                <span>ì¼</span>
            </div>
        </div>
    </header>

    <main class="main">
        <!-- Home Screen -->
        <div class="home" id="home-screen">
            <div class="welcome">
                <h1>ğŸ‘‹ í™˜ì˜í•´ìš”!</h1>
                <p>í•˜ë£¨ í•œ ì±•í„°ì”©, ê²Œì„ ì½”ë”©ì„ ë°°ì›Œë´ìš”</p>
            </div>

            <div class="day-list" id="day-list">
                <!-- Generated by JS -->
            </div>

            <div class="save-section">
                <h3>ğŸ’¾ ì§„í–‰ìƒí™© ì €ì¥</h3>
                <div class="save-btns">
                    <button class="save-btn export" onclick="exportProgress()">ğŸ“¤ ë°±ì—…</button>
                    <button class="save-btn import" onclick="document.getElementById('import-file').click()">ğŸ“¥ ë³µì›</button>
                    <input type="file" id="import-file" accept=".json" style="display:none" onchange="importProgress(event)">
                </div>
                <div class="save-msg" id="save-msg"></div>
            </div>
        </div>

        <!-- Lesson Screen -->
        <div class="lesson" id="lesson-screen">
            <div class="lesson-header">
                <button class="back-btn" onclick="goHome()">â†</button>
                <div class="lesson-title">
                    <h2 id="lesson-title-text">Day 1</h2>
                    <p id="lesson-subtitle-text">ë³€ìˆ˜ ë°°ìš°ê¸°</p>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-steps" id="progress-steps">
                    <!-- Generated by JS -->
                </div>
                <div class="progress-text" id="progress-text">1 / 5</div>
            </div>

            <div class="content-card" id="step-content">
                <!-- Step content loaded here -->
            </div>

            <div class="btn-group" id="btn-group">
                <button class="btn btn-primary" id="next-btn" onclick="nextStep()">ë‹¤ìŒ â†’</button>
            </div>
        </div>
    </main>

    <!-- Reward Modal -->
    <div class="reward-overlay" id="reward-overlay">
        <div class="reward-card">
            <div class="reward-emoji" id="reward-emoji">ğŸ‰</div>
            <h2 class="reward-title">ëŒ€ë‹¨í•´ìš”!</h2>
            <p id="reward-text">ì±•í„°ë¥¼ ì™„ë£Œí–ˆì–´ìš”!</p>
            <div class="reward-xp" id="reward-xp">+50 XP</div>
            <button class="btn btn-primary" onclick="closeReward()" style="width:100%; margin-top:20px;">ê³„ì†í•˜ê¸°</button>
        </div>
    </div>

    <canvas class="confetti-canvas" id="confetti"></canvas>

    <script>
    // ==========================================
    // LESSON DATA
    // ==========================================

    const LESSONS = [
        {
            day: 1,
            title: "ë³€ìˆ˜",
            subtitle: "ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ìƒì",
            icon: "ğŸ“¦",
            xp: 50,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ“¦",
                    title: "ë³€ìˆ˜ê°€ ë­˜ê¹Œìš”?",
                    content: `
                        <p><strong>ë³€ìˆ˜</strong>ëŠ” <strong>ì´ë¦„í‘œê°€ ë¶™ì€ ìƒì</strong>ì˜ˆìš”.</p>
                        <p>ìƒì ì•ˆì— ë­”ê°€ë¥¼ ë„£ì–´ë‘ë©´, ë‚˜ì¤‘ì— ì´ë¦„í‘œë¡œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”!</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ ì˜ˆì‹œ</strong><br>
                            í•¸ë“œí° ì—°ë½ì²˜: "ì—„ë§ˆ" â†’ "010-1234-5678"<br>
                            ì´ë¦„í‘œê°€ "ì—„ë§ˆ", ê°’ì´ ì „í™”ë²ˆí˜¸!
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>ì½”ë“œì—ì„œëŠ” ì´ë ‡ê²Œ ì¨ìš”:</p>
                    `,
                    code: `var ì´ë¦„ = ê°’;

// ì˜ˆì‹œ
var score = 100;
var name = "ì˜ì›…";`
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì§ì ‘ í•´ë³´ì„¸ìš”!",
                    content: `
                        <p><strong>myAge</strong>ë¼ëŠ” ë³€ìˆ˜ë¥¼ ë§Œë“¤ê³  <strong>25</strong>ë¥¼ ë„£ì–´ë³´ì„¸ìš”.</p>
                    `,
                    placeholder: "var myAge = ",
                    answer: "var myAge = 25",
                    hint: "var myAge = 25 ì²˜ëŸ¼ ì¨ìš”. var(ë³€ìˆ˜ ì„ ì–¸) + ì´ë¦„ + =(ê°™ë‹¤) + ê°’"
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ì‹¤ì œ ê²Œì„ ì½”ë“œì—ì„œ",
                    content: `
                        <p>ë‹¹ì‹ ì˜ ê²Œì„ì—ì„œ ë³€ìˆ˜ê°€ ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ ë´ìš”:</p>
                    `,
                    code: `var gameChar_x = 512;  // ìºë¦­í„° Xìœ„ì¹˜
var gameChar_y = 432;  // ìºë¦­í„° Yìœ„ì¹˜
var isLeft = false;    // ì™¼ìª½ ì´ë™ì¤‘?
var gravity = 2;       // ì¤‘ë ¥`,
                    explanation: "ìºë¦­í„° ìœ„ì¹˜, ì´ë™ ìƒíƒœ, ì¤‘ë ¥ ë“±ì„ ë³€ìˆ˜ë¡œ ì €ì¥í•´ìš”!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "ì ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜ë¥¼ ë§Œë“œëŠ” ì˜¬ë°”ë¥¸ ë°©ë²•ì€?",
                    options: [
                        "score = var 100",
                        "var score = 100",
                        "100 = score",
                        "var = score 100"
                    ],
                    correct: 1,
                    explanation: "var ë³€ìˆ˜ì´ë¦„ = ê°’; ìˆœì„œë¡œ ì¨ì•¼ í•´ìš”. var score = 100; ì´ ì •ë‹µ!"
                }
            ]
        },
        {
            day: 2,
            title: "ë„í˜• ê·¸ë¦¬ê¸°",
            subtitle: "rect, ellipse, fill ë°°ìš°ê¸°",
            icon: "ğŸ¨",
            xp: 60,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ¨",
                    title: "p5.jsê°€ ë­ì˜ˆìš”?",
                    content: `
                        <p>p5.jsëŠ” <strong>ê·¸ë¦¼ ê·¸ë¦¬ê¸° ë„êµ¬</strong>ì˜ˆìš”.</p>
                        <p>ì½”ë“œë¡œ ë„í˜•, ìƒ‰ê¹”, ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”!</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ ë‘ ê°€ì§€ í•¨ìˆ˜</strong><br>
                            <strong>setup()</strong> - ì‹œì‘í•  ë•Œ í•œ ë²ˆë§Œ ì‹¤í–‰<br>
                            <strong>draw()</strong> - 1ì´ˆì— 60ë²ˆ ë°˜ë³µ ì‹¤í–‰
                        </div>
                    `
                },
                {
                    type: "shape_demo",
                    emoji: "ğŸ“",
                    title: "rect() - ì‚¬ê°í˜•",
                    content: `<p><strong>rect()</strong>ëŠ” ì‚¬ê°í˜•ì„ ê·¸ë ¤ìš”.</p>`,
                    shapes: [
                        {
                            name: "rect(x, y, ê°€ë¡œ, ì„¸ë¡œ)",
                            code: "rect(20, 20, 80, 50)",
                            explanation: "x=20, y=20 ìœ„ì¹˜ì— ê°€ë¡œ 80, ì„¸ë¡œ 50 ì‚¬ê°í˜•",
                            draw: (p) => {
                                p.fill(100, 150, 255);
                                p.rect(20, 20, 80, 50);
                            }
                        }
                    ]
                },
                {
                    type: "shape_demo",
                    emoji: "â­•",
                    title: "ellipse() - ì›/íƒ€ì›",
                    content: `<p><strong>ellipse()</strong>ëŠ” ì›ì´ë‚˜ íƒ€ì›ì„ ê·¸ë ¤ìš”.</p>`,
                    shapes: [
                        {
                            name: "ellipse(x, y, ê°€ë¡œ, ì„¸ë¡œ)",
                            code: "ellipse(60, 50, 80, 80)",
                            explanation: "x=60, y=50 ìœ„ì¹˜ì— ì§€ë¦„ 80ì¸ ì› (ê°€ë¡œ=ì„¸ë¡œë©´ ì›!)",
                            draw: (p) => {
                                p.fill(255, 100, 150);
                                p.ellipse(60, 50, 80, 80);
                            }
                        }
                    ]
                },
                {
                    type: "shape_demo",
                    emoji: "ğŸ¨",
                    title: "fill() - ìƒ‰ì¹ í•˜ê¸°",
                    content: `<p><strong>fill()</strong>ì€ ë„í˜• ì•ˆì„ ìƒ‰ì¹ í•´ìš”. ë‹¤ìŒ ë„í˜•ë¶€í„° ì ìš©ë¼ìš”!</p>`,
                    shapes: [
                        {
                            name: "fill(ë¹¨ê°•, ì´ˆë¡, íŒŒë‘)",
                            code: "fill(255, 0, 0);\nrect(20, 20, 80, 60)",
                            explanation: "ë¹¨ê°• 255, ì´ˆë¡ 0, íŒŒë‘ 0 = ë¹¨ê°„ìƒ‰!",
                            draw: (p) => {
                                p.fill(255, 0, 0);
                                p.rect(20, 20, 80, 60);
                            }
                        }
                    ]
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "ì§ì ‘ ê·¸ë ¤ë³´ì„¸ìš”!",
                    content: `<p>ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  <strong>ì‹¤í–‰</strong>ì„ ëˆŒëŸ¬ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”!</p>`,
                    defaultCode: `// ìƒ‰ ë³€ê²½í•´ë³´ì„¸ìš”!
fill(100, 200, 100);
rect(10, 10, 50, 50);

fill(200, 100, 200);
ellipse(90, 50, 40, 40);`,
                    canvasSize: { w: 120, h: 100 }
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì—°ìŠµë¬¸ì œ",
                    content: `
                        <p>ìœ„ì¹˜ (100, 100)ì— ê°€ë¡œ 50, ì„¸ë¡œ 30ì¸ <strong>ì‚¬ê°í˜•</strong>ì„ ê·¸ë ¤ë³´ì„¸ìš”.</p>
                    `,
                    placeholder: "rect(",
                    answer: "rect(100, 100, 50, 30)",
                    hint: "rect(xì¢Œí‘œ, yì¢Œí‘œ, ê°€ë¡œê¸¸ì´, ì„¸ë¡œê¸¸ì´) í˜•íƒœë¡œ ì¨ìš”. ìˆ«ìë¥¼ ìˆœì„œëŒ€ë¡œ ë„£ìœ¼ë©´ ë¼ìš”!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "1ì´ˆì— 60ë²ˆ ë°˜ë³µ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ëŠ”?",
                    options: [
                        "setup()",
                        "draw()",
                        "rect()",
                        "fill()"
                    ],
                    correct: 1,
                    explanation: "draw()ëŠ” 1ì´ˆì— 60ë²ˆ ë°˜ë³µ ì‹¤í–‰ë¼ìš”. setup()ì€ ì‹œì‘í•  ë•Œ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ê³ , rect()ì™€ fill()ì€ ë„í˜•ì„ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ì˜ˆìš”."
                }
            ]
        },
        {
            day: 3,
            title: "ì¡°ê±´ë¬¸",
            subtitle: "ë§Œì•½ ~ë¼ë©´",
            icon: "ğŸ”€",
            xp: 60,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ”€",
                    title: "ì¡°ê±´ë¬¸ì´ ë­ì˜ˆìš”?",
                    content: `
                        <p>ì‹¤ìƒí™œì—ì„œ:</p>
                        <p>"<strong>ë§Œì•½</strong> ë¹„ê°€ ì˜¤ë©´ ìš°ì‚°ì„ ì“°ê³ , <strong>ì•„ë‹ˆë©´</strong> ì„ ê¸€ë¼ìŠ¤ë¥¼ ì¨"</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ ì½”ë“œì—ì„œë„ ë˜‘ê°™ì•„ìš”!</strong><br>
                            if (ì¡°ê±´) { ì´ê±° ì‹¤í–‰ }<br>
                            else { ì €ê±° ì‹¤í–‰ }
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>ì²´ë ¥ì´ 0ë³´ë‹¤ í¬ë©´ "ìƒì¡´", ì•„ë‹ˆë©´ "ê²Œì„ì˜¤ë²„":</p>
                    `,
                    code: `var health = 100;

if (health > 0) {
    console.log("ìƒì¡´!");
} else {
    console.log("ê²Œì„ì˜¤ë²„");
}`
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "ì¡°ê±´ë¬¸ìœ¼ë¡œ ìƒ‰ ë°”ê¾¸ê¸°",
                    content: `<p>x ê°’ì— ë”°ë¼ ìƒ‰ì´ ë°”ë€Œì–´ìš”! xë¥¼ ë°”ê¿”ë³´ì„¸ìš”.</p>`,
                    defaultCode: `var x = 60;

if (x > 50) {
    fill(0, 255, 0);  // ì´ˆë¡
} else {
    fill(255, 0, 0);  // ë¹¨ê°•
}
ellipse(60, 50, 60, 60);`,
                    canvasSize: { w: 120, h: 100 }
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì§ì ‘ í•´ë³´ì„¸ìš”!",
                    content: `
                        <p>scoreê°€ 50ë³´ë‹¤ í¬ë©´ "í•©ê²©"ì„ ì¶œë ¥í•˜ëŠ” ì¡°ê±´ë¬¸ì„ ì™„ì„±í•˜ì„¸ìš”.</p>
                    `,
                    placeholder: "if (score ",
                    answer: "if (score > 50)",
                    hint: "if (score > 50) ì²˜ëŸ¼ ì¨ìš”. > ëŠ” 'ë³´ë‹¤ í¬ë‹¤'ëŠ” ëœ»! ê´„í˜¸ ë‹«ëŠ” ê±° ìŠì§€ ë§ˆì„¸ìš”."
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ê²Œì„ì—ì„œ ì¡°ê±´ë¬¸",
                    content: `
                        <p>ìºë¦­í„° í¬ì¦ˆë¥¼ ì¡°ê±´ë¬¸ìœ¼ë¡œ ê²°ì •í•´ìš”:</p>
                    `,
                    code: `if (isLeft) {
    // ì™¼ìª½ ê±·ëŠ” ê·¸ë¦¼
} else if (isRight) {
    // ì˜¤ë¥¸ìª½ ê±·ëŠ” ê·¸ë¦¼
} else {
    // ì„œìˆëŠ” ê·¸ë¦¼
}`,
                    explanation: "ì™¼ìª½í‚¤ë¥¼ ëˆ„ë¥´ë©´ isLeftê°€ trueê°€ ë¼ìš”!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "if (x > 10)ì€ ì–¸ì œ ì‹¤í–‰ë ê¹Œìš”?",
                    options: [
                        "xê°€ 10ì¼ ë•Œ",
                        "xê°€ 10ë³´ë‹¤ í´ ë•Œ",
                        "xê°€ 10ë³´ë‹¤ ì‘ì„ ë•Œ",
                        "í•­ìƒ"
                    ],
                    correct: 1,
                    explanation: "> ëŠ” 'ë³´ë‹¤ í¬ë‹¤'ë¼ëŠ” ëœ»ì´ì—ìš”. x > 10ì€ xê°€ 10ë³´ë‹¤ í´ ë•Œë§Œ trueê°€ ë¼ìš”. xê°€ ë”± 10ì´ë©´ falseì˜ˆìš”!"
                }
            ]
        },
        {
            day: 4,
            title: "Boolean",
            subtitle: "ì°¸ ë˜ëŠ” ê±°ì§“",
            icon: "âœ…",
            xp: 50,
            steps: [
                {
                    type: "intro",
                    emoji: "âœ…",
                    title: "Booleanì´ ë­ì˜ˆìš”?",
                    content: `
                        <p>Booleanì€ ë”± <strong>ë‘ ê°€ì§€</strong>ë§Œ ê°€ëŠ¥í•´ìš”:</p>
                        <p style="font-size: 1.5rem; text-align: center; margin: 20px 0;">
                            <span style="color: #10b981;">true (ì°¸)</span> ë˜ëŠ”
                            <span style="color: #ef4444;">false (ê±°ì§“)</span>
                        </p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ ì „ë“± ìŠ¤ìœ„ì¹˜ì²˜ëŸ¼!</strong><br>
                            ì¼œì§(true) ë˜ëŠ” êº¼ì§(false), ì¤‘ê°„ì€ ì—†ì–´ìš”!
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>ê²Œì„ì—ì„œ ìƒíƒœë¥¼ ì¶”ì í•  ë•Œ ì“°ì—¬ìš”:</p>
                    `,
                    code: `var isRunning = false;  // ë‹¬ë¦¬ëŠ” ì¤‘ ì•„ë‹˜
var hasKey = true;      // ì—´ì‡  ìˆìŒ
var gameOver = false;   // ê²Œì„ ì§„í–‰ì¤‘`
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "Booleanìœ¼ë¡œ ìŠ¤ìœ„ì¹˜ ë§Œë“¤ê¸°",
                    content: `<p>isOnì„ true/falseë¡œ ë°”ê¿”ë³´ì„¸ìš”!</p>`,
                    defaultCode: `var isOn = true;

if (isOn) {
    fill(255, 255, 0);  // ë…¸ë‘(ì¼œì§)
} else {
    fill(100, 100, 100); // íšŒìƒ‰(êº¼ì§)
}
ellipse(60, 50, 70, 70);`,
                    canvasSize: { w: 120, h: 100 }
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì§ì ‘ í•´ë³´ì„¸ìš”!",
                    content: `
                        <p><strong>isJumping</strong> ë³€ìˆ˜ë¥¼ ë§Œë“¤ê³  <strong>true</strong>ë¥¼ ë„£ìœ¼ì„¸ìš”.</p>
                    `,
                    placeholder: "var isJumping = ",
                    answer: "var isJumping = true",
                    hint: "var isJumping = true ì²˜ëŸ¼ ì¨ìš”. trueëŠ” ë”°ì˜´í‘œ ì—†ì´! \"true\"ê°€ ì•„ë‹ˆë¼ ê·¸ëƒ¥ true"
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ê²Œì„ì—ì„œ Boolean",
                    content: `
                        <p>í‚¤ë¥¼ ëˆ„ë¥´ë©´ true, ë–¼ë©´ false:</p>
                    `,
                    code: `// í‚¤ ëˆ„ë¥´ë©´
function keyPressed() {
    if (keyCode == 37) {  // ì™¼ìª½ í™”ì‚´í‘œ
        isLeft = true;
    }
}

// í‚¤ ë–¼ë©´
function keyReleased() {
    if (keyCode == 37) {
        isLeft = false;
    }
}`,
                    explanation: "isLeftê°€ trueë©´ ìºë¦­í„°ê°€ ì™¼ìª½ìœ¼ë¡œ ì›€ì§ì—¬ìš”!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "Boolean ê°’ì´ ì•„ë‹Œ ê²ƒì€?",
                    options: [
                        "true",
                        "false",
                        "maybe",
                        "ë‘˜ ë‹¤ Boolean"
                    ],
                    correct: 2,
                    explanation: "Booleanì€ true ë˜ëŠ” false ë”± ë‘ ê°€ì§€ë§Œ ìˆì–´ìš”. maybeëŠ” Booleanì´ ì•„ë‹ˆë¼ ê·¸ëƒ¥ ë¬¸ìì—´ì´ì—ìš”!"
                }
            ]
        },
        {
            day: 5,
            title: "ë°°ì—´",
            subtitle: "ì—¬ëŸ¬ ê°’ì„ í•œ ë²ˆì—",
            icon: "ğŸ“š",
            xp: 70,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ“š",
                    title: "ë°°ì—´ì´ ë­ì˜ˆìš”?",
                    content: `
                        <p><strong>ë°°ì—´</strong>ì€ ì—¬ëŸ¬ ê°’ì„ <strong>í•œ ì¤„ë¡œ ì €ì¥</strong>í•´ìš”.</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ ë³€ìˆ˜ vs ë°°ì—´</strong><br>
                            ë³€ìˆ˜: var tree1=100; var tree2=200; (ê·€ì°®ìŒ)<br>
                            ë°°ì—´: var trees = [100, 200, 300]; (í¸í•¨!)
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>ëŒ€ê´„í˜¸ [ ] ì•ˆì— ê°’ì„ ë„£ì–´ìš”:</p>
                    `,
                    code: `var scores = [100, 85, 92];

// ê°’ ê°€ì ¸ì˜¤ê¸° (0ë¶€í„° ì‹œì‘!)
scores[0]  // 100 (ì²«ë²ˆì§¸)
scores[1]  // 85  (ë‘ë²ˆì§¸)
scores[2]  // 92  (ì„¸ë²ˆì§¸)`
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "ë°°ì—´ë¡œ ì—¬ëŸ¬ ì› ê·¸ë¦¬ê¸°",
                    content: `<p>ë°°ì—´ ê°’ì„ ë°”ê¾¸ë©´ ì› ìœ„ì¹˜ê°€ ë°”ë€Œì–´ìš”!</p>`,
                    defaultCode: `var xPositions = [20, 60, 100];

fill(255, 100, 100);
ellipse(xPositions[0], 50, 30, 30);
ellipse(xPositions[1], 50, 30, 30);
ellipse(xPositions[2], 50, 30, 30);`,
                    canvasSize: { w: 130, h: 100 }
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì§ì ‘ í•´ë³´ì„¸ìš”!",
                    content: `
                        <p><strong>colors</strong> ë°°ì—´ì— "red", "blue", "green"ì„ ë„£ìœ¼ì„¸ìš”.</p>
                    `,
                    placeholder: 'var colors = [',
                    answer: 'var colors = ["red", "blue", "green"]',
                    hint: 'var colors = ["red", "blue", "green"] ì²˜ëŸ¼ ì¨ìš”. ë¬¸ìì—´ì€ "ë”°ì˜´í‘œ"ë¡œ ê°ì‹¸ê³ , ì‰¼í‘œë¡œ êµ¬ë¶„!'
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ê²Œì„ì—ì„œ ë°°ì—´",
                    content: `
                        <p>ë‚˜ë¬´ ìœ„ì¹˜ë¥¼ ë°°ì—´ë¡œ ì €ì¥í•´ìš”:</p>
                    `,
                    code: `// ë‚˜ë¬´ë“¤ì˜ X ìœ„ì¹˜
var trees_x = [100, 300, 500, 900, 1100];

// trees_x[0] = 100 (ì²«ë²ˆì§¸ ë‚˜ë¬´)
// trees_x[4] = 1100 (ë‹¤ì„¯ë²ˆì§¸ ë‚˜ë¬´)`,
                    explanation: "11ê°œ ë‚˜ë¬´ ìœ„ì¹˜ë¥¼ ë³€ìˆ˜ 11ê°œ ëŒ€ì‹  ë°°ì—´ 1ê°œë¡œ!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "var arr = [10, 20, 30]; ì¼ ë•Œ arr[1]ì€?",
                    options: [
                        "10",
                        "20",
                        "30",
                        "ì—ëŸ¬"
                    ],
                    correct: 1,
                    explanation: "ë°°ì—´ ì¸ë±ìŠ¤ëŠ” 0ë¶€í„° ì‹œì‘í•´ìš”! arr[0]=10, arr[1]=20, arr[2]=30. ê·¸ë˜ì„œ arr[1]ì€ 20ì´ì—ìš”."
                }
            ]
        },
        {
            day: 6,
            title: "ë°˜ë³µë¬¸",
            subtitle: "forë¡œ ë°˜ë³µí•˜ê¸°",
            icon: "ğŸ”„",
            xp: 80,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ”„",
                    title: "ë°˜ë³µë¬¸ì´ ë­ì˜ˆìš”?",
                    content: `
                        <p>ê°™ì€ ì‘ì—…ì„ <strong>ì—¬ëŸ¬ ë²ˆ ë°˜ë³µ</strong>í•´ìš”.</p>
                        <p>ë‚˜ë¬´ 10ê°œë¥¼ ê·¸ë¦¬ë ¤ë©´, ê°™ì€ ì½”ë“œë¥¼ 10ë²ˆ ì“¸ í•„ìš” ì—†ì´ ë°˜ë³µë¬¸ í•œ ë²ˆì´ë©´ ë¼ìš”!</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ forë¬¸ êµ¬ì¡°</strong><br>
                            for (ì‹œì‘; ì¡°ê±´; ì¦ê°€) {<br>
                            &nbsp;&nbsp;ë°˜ë³µí•  ì½”ë“œ<br>
                            }
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>0ë¶€í„° 4ê¹Œì§€ 5ë²ˆ ë°˜ë³µ:</p>
                    `,
                    code: `for (var i = 0; i < 5; i++) {
    console.log(i);
}
// ì¶œë ¥: 0, 1, 2, 3, 4`
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "ë°˜ë³µë¬¸ìœ¼ë¡œ ì› ì—¬ëŸ¬ê°œ ê·¸ë¦¬ê¸°",
                    content: `<p>i < 5 ìˆ«ìë¥¼ ë°”ê¾¸ë©´ ì› ê°œìˆ˜ê°€ ë°”ë€Œì–´ìš”!</p>`,
                    defaultCode: `fill(100, 200, 255);

for (var i = 0; i < 5; i++) {
    ellipse(20 + i * 25, 50, 20, 20);
}`,
                    canvasSize: { w: 140, h: 100 }
                },
                {
                    type: "practice",
                    emoji: "âœï¸",
                    title: "ì§ì ‘ í•´ë³´ì„¸ìš”!",
                    content: `
                        <p>3ë²ˆ ë°˜ë³µí•˜ëŠ” forë¬¸ì˜ ì¡°ê±´ì„ ì™„ì„±í•˜ì„¸ìš”.</p>
                    `,
                    placeholder: "for (var i = 0; i < ",
                    answer: "for (var i = 0; i < 3; i++)",
                    hint: "for (var i = 0; i < 3; i++) ì²˜ëŸ¼ ì¨ìš”. 3ë²ˆ ë°˜ë³µì´ë©´ i < 3, ë§ˆì§€ë§‰ì— i++ ìŠì§€ ë§ˆì„¸ìš”!"
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ê²Œì„ì—ì„œ ë°˜ë³µë¬¸",
                    content: `
                        <p>ëª¨ë“  ë‚˜ë¬´ë¥¼ í•œ ë²ˆì— ê·¸ë ¤ìš”:</p>
                    `,
                    code: `var trees_x = [100, 300, 500];

for (var i = 0; i < trees_x.length; i++) {
    // trees_x[i] = í˜„ì¬ ë‚˜ë¬´ ìœ„ì¹˜
    rect(trees_x[i], 300, 50, 100);
}`,
                    explanation: "trees_x.lengthëŠ” ë°°ì—´ ê¸¸ì´(3)ì˜ˆìš”!"
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "í€´ì¦ˆ!",
                    question: "for(var i=0; i<3; i++)ëŠ” ëª‡ ë²ˆ ì‹¤í–‰?",
                    options: [
                        "2ë²ˆ",
                        "3ë²ˆ",
                        "4ë²ˆ",
                        "ë¬´í•œ"
                    ],
                    correct: 1,
                    explanation: "iê°€ 0, 1, 2ì¼ ë•Œ ì‹¤í–‰ë˜ê³ , iê°€ 3ì´ ë˜ë©´ i<3ì´ falseê°€ ë¼ì„œ ë©ˆì¶°ìš”. ê·¸ë˜ì„œ ì´ 3ë²ˆ!"
                }
            ]
        },
        {
            day: 7,
            title: "ì¹´ë©”ë¼",
            subtitle: "í™”ë©´ ìŠ¤í¬ë¡¤",
            icon: "ğŸ¥",
            xp: 100,
            steps: [
                {
                    type: "intro",
                    emoji: "ğŸ¥",
                    title: "ì¹´ë©”ë¼ê°€ ë­ì˜ˆìš”?",
                    content: `
                        <p>íš¡ìŠ¤í¬ë¡¤ ê²Œì„ì—ì„œ ìºë¦­í„°ëŠ” <strong>í™”ë©´ ì¤‘ì•™</strong>ì— ìˆê³ ,</p>
                        <p><strong>ë°°ê²½ì´ ì›€ì§ì´ëŠ” ê²ƒì²˜ëŸ¼</strong> ë³´ì—¬ìš”!</p>
                        <div class="highlight-box">
                            <strong>ğŸ’¡ í•µì‹¬ í•¨ìˆ˜</strong><br>
                            <strong>push()</strong> - ìƒíƒœ ì €ì¥<br>
                            <strong>translate(x, y)</strong> - í™”ë©´ ì´ë™<br>
                            <strong>pop()</strong> - ìƒíƒœ ë³µì›
                        </div>
                    `
                },
                {
                    type: "example",
                    emoji: "ğŸ‘€",
                    title: "ì½”ë“œë¡œ ë³´ë©´",
                    content: `
                        <p>translateë¡œ ê·¸ë¦¬ëŠ” ìœ„ì¹˜ë¥¼ ì˜®ê²¨ìš”:</p>
                    `,
                    code: `push();           // ì €ì¥
translate(-100, 0); // ì™¼ìª½ìœ¼ë¡œ 100 ì´ë™

// ì—¬ê¸° ê·¸ë¦¬ëŠ” ê±´ ë‹¤ 100 ì™¼ìª½ì— ê·¸ë ¤ì§
rect(0, 0, 50, 50);

pop();            // ë³µì›`
                },
                {
                    type: "interactive",
                    emoji: "ğŸ–Œï¸",
                    title: "translate ì‹¤í—˜í•˜ê¸°",
                    content: `<p>translate ê°’ì„ ë°”ê¿”ë³´ì„¸ìš”! ì‚¬ê°í˜•ì´ ì›€ì§ì—¬ìš”.</p>`,
                    defaultCode: `fill(100, 200, 100);
rect(10, 30, 40, 40);

// translateë¡œ ì´ë™!
translate(50, 0);

fill(255, 100, 100);
rect(10, 30, 40, 40);`,
                    canvasSize: { w: 140, h: 100 }
                },
                {
                    type: "game_code",
                    emoji: "ğŸ®",
                    title: "ê²Œì„ ì¹´ë©”ë¼ ì½”ë“œ",
                    content: `
                        <p>ìºë¦­í„°ë¥¼ ë”°ë¼ê°€ëŠ” ì¹´ë©”ë¼:</p>
                    `,
                    code: `// ì¹´ë©”ë¼ ìœ„ì¹˜ ê³„ì‚°
cameraPosX = gameChar_x - width/2;

push();
translate(-cameraPosX, 0);

// ì—¬ê¸°ì— ë°°ê²½, ë‚˜ë¬´, êµ¬ë¦„ ê·¸ë¦¬ê¸°
// (ë‹¤ ê°™ì´ ìŠ¤í¬ë¡¤ë¨)

pop();`,
                    explanation: "ìºë¦­í„°ê°€ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°€ë©´, ë°°ê²½ì´ ì™¼ìª½ìœ¼ë¡œ ë°€ë ¤ìš”!"
                },
                {
                    type: "intro",
                    emoji: "ğŸ“",
                    title: "ì¶•í•˜í•´ìš”!",
                    content: `
                        <p>7ì¼ ë™ì•ˆ ë°°ìš´ ê²ƒë“¤:</p>
                        <div class="highlight-box success">
                            âœ… <strong>ë³€ìˆ˜</strong> - ë°ì´í„° ì €ì¥<br>
                            âœ… <strong>ë„í˜•</strong> - rect, ellipse, fill<br>
                            âœ… <strong>ì¡°ê±´ë¬¸</strong> - if/else<br>
                            âœ… <strong>Boolean</strong> - true/false<br>
                            âœ… <strong>ë°°ì—´</strong> - ì—¬ëŸ¬ ê°’ ì €ì¥<br>
                            âœ… <strong>ë°˜ë³µë¬¸</strong> - for<br>
                            âœ… <strong>ì¹´ë©”ë¼</strong> - push, translate, pop
                        </div>
                        <p>ì´ì œ ê²Œì„ ì½”ë“œë¥¼ ì´í•´í•  ìˆ˜ ìˆì–´ìš”! ğŸ®</p>
                    `
                },
                {
                    type: "quiz",
                    emoji: "ğŸ§ ",
                    title: "ë§ˆì§€ë§‰ í€´ì¦ˆ!",
                    question: "í™”ë©´ì„ ìŠ¤í¬ë¡¤ì‹œí‚¤ëŠ” í•¨ìˆ˜ëŠ”?",
                    options: [
                        "scroll()",
                        "move()",
                        "translate()",
                        "shift()"
                    ],
                    correct: 2,
                    explanation: "translate(x, y)ëŠ” ì¢Œí‘œê³„ë¥¼ ì´ë™ì‹œì¼œì„œ í™”ë©´ ìŠ¤í¬ë¡¤ íš¨ê³¼ë¥¼ ë§Œë“¤ì–´ìš”. push()ì™€ pop()ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ìš”!"
                }
            ]
        }
    ];

    // ==========================================
    // STATE
    // ==========================================

    let state = {
        xp: 0,
        streak: 0,
        completedDays: [],
        dayProgress: {},
        lastVisit: null
    };

    let currentDay = null;
    let currentStep = 0;
    let quizAnswered = false;
    let practiceCompleted = false;
    let currentP5Instance = null;
    let interactiveEditor = null;
    let practiceEditor = null;

    // ==========================================
    // INIT
    // ==========================================

    function init() {
        loadState();
        checkStreak();
        renderHome();
        updateStats();
    }

    function loadState() {
        const saved = localStorage.getItem('p5js_master_v3');
        if (saved) {
            state = { ...state, ...JSON.parse(saved) };
        }
    }

    function saveState() {
        localStorage.setItem('p5js_master_v3', JSON.stringify(state));
    }

    function checkStreak() {
        const today = new Date().toDateString();
        if (state.lastVisit !== today) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            if (state.lastVisit === yesterday.toDateString()) {
                state.streak++;
            } else if (state.lastVisit) {
                state.streak = 1;
            } else {
                state.streak = 1;
            }
            state.lastVisit = today;
            saveState();
        }
    }

    function updateStats() {
        document.getElementById('xp-display').textContent = state.xp;
        document.getElementById('streak-display').textContent = state.streak;
    }

    // ==========================================
    // HOME SCREEN
    // ==========================================

    function renderHome() {
        const list = document.getElementById('day-list');
        list.innerHTML = '';

        LESSONS.forEach((lesson, idx) => {
            const isCompleted = state.completedDays.includes(lesson.day);
            const isLocked = idx > 0 && !state.completedDays.includes(LESSONS[idx-1].day);
            const progress = state.dayProgress[lesson.day] || 0;

            const item = document.createElement('div');
            item.className = `day-item ${isCompleted ? 'completed' : ''} ${isLocked ? 'locked' : ''}`;

            item.innerHTML = `
                <div class="day-icon">${lesson.icon}</div>
                <div class="day-info">
                    <h3>Day ${lesson.day}: ${lesson.title}</h3>
                    <p>${lesson.subtitle}</p>
                </div>
                <div class="day-progress">
                    ${isCompleted ? 'âœ… ì™„ë£Œ' : isLocked ? 'ğŸ”’' : `${progress}/${lesson.steps.length}`}
                </div>
            `;

            if (!isLocked) {
                item.onclick = () => startLesson(lesson.day);
            }

            list.appendChild(item);
        });
    }

    function goHome() {
        if (currentP5Instance) {
            currentP5Instance.remove();
            currentP5Instance = null;
        }
        document.getElementById('home-screen').classList.remove('hidden');
        document.getElementById('lesson-screen').classList.remove('active');
        renderHome();
    }

    // ==========================================
    // LESSON SCREEN
    // ==========================================

    function startLesson(dayNum) {
        currentDay = LESSONS.find(l => l.day === dayNum);
        currentStep = state.dayProgress[dayNum] || 0;

        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('lesson-screen').classList.add('active');

        document.getElementById('lesson-title-text').textContent = `Day ${currentDay.day}: ${currentDay.title}`;
        document.getElementById('lesson-subtitle-text').textContent = currentDay.subtitle;

        renderProgress();
        renderStep();
    }

    function renderProgress() {
        const container = document.getElementById('progress-steps');
        container.innerHTML = '';

        currentDay.steps.forEach((_, idx) => {
            const step = document.createElement('div');
            step.className = 'progress-step';
            if (idx < currentStep) step.classList.add('completed');
            if (idx === currentStep) step.classList.add('current');
            container.appendChild(step);
        });

        document.getElementById('progress-text').textContent =
            `${currentStep + 1} / ${currentDay.steps.length}`;
    }

    function renderStep() {
        // Clean up previous instances
        if (currentP5Instance) {
            currentP5Instance.remove();
            currentP5Instance = null;
        }
        if (interactiveEditor) {
            interactiveEditor = null;
        }
        if (practiceEditor) {
            practiceEditor = null;
        }

        const step = currentDay.steps[currentStep];
        const content = document.getElementById('step-content');
        quizAnswered = false;
        practiceCompleted = false;

        let html = `
            <div class="step-emoji">${step.emoji}</div>
            <h3 class="step-title">${step.title}</h3>
            <div class="step-content">${step.content || ''}</div>
        `;

        if (step.type === 'example' || step.type === 'game_code') {
            html += `<div class="code-readonly">${escapeHtml(step.code)}</div>`;
            if (step.explanation) {
                html += `<div class="highlight-box success">${step.explanation}</div>`;
            }
        }

        if (step.type === 'shape_demo') {
            html += `<div class="shape-demo">`;
            step.shapes.forEach((shape, idx) => {
                html += `
                    <div class="shape-demo-item">
                        <div class="shape-demo-content">
                            <div>
                                <div class="shape-code">${escapeHtml(shape.code)}</div>
                                <p style="color: var(--muted); font-size: 0.85rem; margin-top: 10px;">${shape.explanation}</p>
                            </div>
                            <div class="shape-canvas" id="shape-canvas-${idx}"></div>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
        }

        if (step.type === 'interactive') {
            html += `
                <div class="code-preview-container">
                    <div class="code-section">
                        <div class="code-label">ğŸ’» ì½”ë“œ (ìˆ˜ì •í•´ë³´ì„¸ìš”!)</div>
                        <div class="cm-wrapper">
                            <div id="interactive-code-editor"></div>
                        </div>
                    </div>
                    <div class="preview-section">
                        <div class="preview-label">ğŸ‘ï¸ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°</div>
                        <div class="preview-canvas-wrapper" id="interactive-preview"></div>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-run" onclick="runInteractiveCode()">â–¶ ì‹¤í–‰</button>
                </div>
                <div class="editor-hint">ğŸ’¡ ì½”ë“œë¥¼ ë°”ê¾¸ê³  "ì‹¤í–‰"ì„ ëˆŒëŸ¬ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”! (Tabìœ¼ë¡œ ë“¤ì—¬ì“°ê¸°)</div>
            `;
        }

        if (step.type === 'practice') {
            html += `
                <div class="code-section">
                    <div class="code-label">ğŸ’» ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”:</div>
                    <div class="code-editor" id="code-editor">
                        <div id="practice-code-editor"></div>
                        <div class="code-result" id="code-result"></div>
                    </div>
                </div>
                <div class="btn-group" id="practice-btns">
                    <button class="btn btn-check" onclick="checkCode()">í™•ì¸í•˜ê¸° âœ“</button>
                </div>
                <p style="color: var(--muted); font-size: 0.85rem; margin-top: 10px;">ğŸ’¡ íŒíŠ¸: ${step.hint}</p>
            `;
        }

        if (step.type === 'quiz') {
            html += `
                <p style="font-size: 1.1rem; margin-bottom: 20px; color: var(--text);">${step.question}</p>
                <div class="quiz-options" id="quiz-options">
                    ${step.options.map((opt, idx) => `
                        <div class="quiz-option" onclick="selectQuiz(${idx})" data-idx="${idx}">
                            ${String.fromCharCode(65 + idx)}. ${opt}
                        </div>
                    `).join('')}
                </div>
                <div class="quiz-explanation" id="quiz-explanation" style="display:none; margin-top: 20px;"></div>
            `;
        }

        content.innerHTML = html;

        // Update buttons
        const btnGroup = document.getElementById('btn-group');
        if (step.type === 'practice') {
            btnGroup.innerHTML = '';
        } else if (step.type === 'quiz') {
            btnGroup.innerHTML = `
                <button class="btn btn-primary" id="next-btn" onclick="nextStep()" disabled>ë‹¤ìŒ â†’</button>
            `;
        } else if (step.type === 'interactive') {
            btnGroup.innerHTML = `
                <button class="btn btn-primary" id="next-btn" onclick="nextStep()">ë‹¤ìŒ â†’</button>
            `;
        } else {
            btnGroup.innerHTML = `
                <button class="btn btn-primary" id="next-btn" onclick="nextStep()">ë‹¤ìŒ â†’</button>
            `;
        }

        // Render shape demos
        if (step.type === 'shape_demo') {
            setTimeout(() => {
                step.shapes.forEach((shape, idx) => {
                    createShapeCanvas(`shape-canvas-${idx}`, shape.draw, 120, 100);
                });
            }, 50);
        }

        // Initialize CodeMirror for interactive
        if (step.type === 'interactive') {
            setTimeout(() => {
                const editorEl = document.getElementById('interactive-code-editor');
                if (editorEl) {
                    interactiveEditor = CodeMirror(editorEl, {
                        value: step.defaultCode,
                        mode: 'javascript',
                        theme: 'dracula',
                        lineNumbers: true,
                        matchBrackets: true,
                        autoCloseBrackets: true,
                        indentUnit: 4,
                        tabSize: 4,
                        indentWithTabs: false,
                        lineWrapping: true
                    });
                    runInteractiveCode();
                }
            }, 50);
        }

        // Initialize CodeMirror for practice
        if (step.type === 'practice') {
            setTimeout(() => {
                const editorEl = document.getElementById('practice-code-editor');
                if (editorEl) {
                    practiceEditor = CodeMirror(editorEl, {
                        value: '',
                        mode: 'javascript',
                        theme: 'dracula',
                        lineNumbers: true,
                        matchBrackets: true,
                        autoCloseBrackets: true,
                        indentUnit: 4,
                        tabSize: 4,
                        indentWithTabs: false,
                        lineWrapping: true,
                        placeholder: step.placeholder
                    });
                }
            }, 50);
        }
    }

    function escapeHtml(text) {
        return text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }

    // ==========================================
    // P5.JS CANVAS
    // ==========================================

    function createShapeCanvas(containerId, drawFunc, w, h) {
        const container = document.getElementById(containerId);
        if (!container) return;

        new p5((p) => {
            p.setup = function() {
                p.createCanvas(w, h);
                p.background(30, 30, 50);
                p.noStroke();
                drawFunc(p);
                p.noLoop();
            };
        }, container);
    }

    function runInteractiveCode() {
        const step = currentDay.steps[currentStep];
        const code = interactiveEditor ? interactiveEditor.getValue() : '';
        const container = document.getElementById('interactive-preview');

        if (currentP5Instance) {
            currentP5Instance.remove();
            currentP5Instance = null;
        }

        container.innerHTML = '';

        const canvasW = step.canvasSize?.w || 120;
        const canvasH = step.canvasSize?.h || 100;

        try {
            currentP5Instance = new p5((p) => {
                p.setup = function() {
                    p.createCanvas(canvasW, canvasH);
                    p.background(30, 30, 50);
                    p.noStroke();

                    try {
                        // Execute user code
                        const func = new Function('p', `
                            with(p) {
                                ${code}
                            }
                        `);
                        func(p);
                    } catch (e) {
                        p.fill(255, 100, 100);
                        p.textSize(12);
                        p.text('Error!', 10, 50);
                    }

                    p.noLoop();
                };
            }, container);
        } catch (e) {
            container.innerHTML = '<p style="color: #ef4444; padding: 20px;">ì½”ë“œ ì˜¤ë¥˜ê°€ ìˆì–´ìš”!</p>';
        }
    }

    // ==========================================
    // CODE CHECKING
    // ==========================================

    let wrongAttempts = 0;

    function checkCode() {
        const step = currentDay.steps[currentStep];
        const input = practiceEditor ? practiceEditor.getValue().trim() : '';
        const result = document.getElementById('code-result');
        const editor = document.getElementById('code-editor');

        // Normalize: remove all spaces, semicolons, and lowercase
        const normalize = (s) => s.replace(/\s+/g, '').replace(/;/g, '').toLowerCase();
        const isCorrect = normalize(input) === normalize(step.answer);

        if (isCorrect) {
            editor.classList.remove('wrong');
            editor.classList.add('correct');
            result.className = 'code-result success';
            result.textContent = 'âœ… ì •ë‹µì´ì—ìš”!';
            practiceCompleted = true;
            wrongAttempts = 0;

            const practiceBtns = document.getElementById('practice-btns');
            practiceBtns.innerHTML = `
                <button class="btn btn-retry" onclick="retryPractice()">ğŸ”„ ë‹¤ì‹œ í•´ë³´ê¸°</button>
                <button class="btn btn-primary" onclick="nextStep()">ë‹¤ìŒ â†’</button>
            `;
        } else {
            wrongAttempts++;
            editor.classList.remove('correct');
            editor.classList.add('wrong');
            result.className = 'code-result error';

            if (wrongAttempts >= 2) {
                result.innerHTML = 'âŒ ë‹¤ì‹œ í•´ë³´ì„¸ìš”! <button onclick="showAnswer()" style="background:#6366f1;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;margin-left:10px;">ğŸ’¡ ì •ë‹µ ë³´ê¸°</button>';
            } else {
                result.textContent = 'âŒ ë‹¤ì‹œ í•´ë³´ì„¸ìš”!';
            }
        }
    }

    function showAnswer() {
        const step = currentDay.steps[currentStep];
        const result = document.getElementById('code-result');
        const editor = document.getElementById('code-editor');

        if (practiceEditor) {
            practiceEditor.setValue(step.answer);
        }
        editor.classList.remove('wrong');
        editor.classList.add('correct');
        result.className = 'code-result success';
        result.innerHTML = 'ğŸ“ ì •ë‹µì´ì—ìš”! ìœ„ ì½”ë“œë¥¼ ì˜ ë³´ê³  ì´í•´í•´ë³´ì„¸ìš”.';

        const practiceBtns = document.getElementById('practice-btns');
        practiceBtns.innerHTML = `
            <button class="btn btn-retry" onclick="retryPractice()">ğŸ”„ ë‹¤ì‹œ í•´ë³´ê¸°</button>
            <button class="btn btn-primary" onclick="nextStep()">ë‹¤ìŒ â†’</button>
        `;
    }

    function retryPractice() {
        const step = currentDay.steps[currentStep];
        const editor = document.getElementById('code-editor');
        const result = document.getElementById('code-result');

        if (practiceEditor) {
            practiceEditor.setValue('');
            practiceEditor.focus();
        }
        editor.classList.remove('correct', 'wrong');
        result.className = 'code-result';
        result.textContent = '';
        wrongAttempts = 0;

        const practiceBtns = document.getElementById('practice-btns');
        practiceBtns.innerHTML = `
            <button class="btn btn-check" onclick="checkCode()">í™•ì¸í•˜ê¸° âœ“</button>
        `;
    }

    // ==========================================
    // QUIZ
    // ==========================================

    function selectQuiz(idx) {
        if (quizAnswered) return;

        const step = currentDay.steps[currentStep];
        const options = document.querySelectorAll('.quiz-option');

        quizAnswered = true;

        options.forEach((opt, i) => {
            opt.onclick = null;
            if (i === step.correct) {
                opt.classList.add('correct');
            } else if (i === idx && i !== step.correct) {
                opt.classList.add('wrong');
            }
        });

        // Show explanation
        const explanationDiv = document.getElementById('quiz-explanation');
        if (explanationDiv && step.explanation) {
            const isCorrect = idx === step.correct;
            explanationDiv.innerHTML = `
                <div class="highlight-box ${isCorrect ? 'success' : ''}">
                    <strong>${isCorrect ? 'âœ… ì •ë‹µ!' : 'âŒ ì˜¤ë‹µ!'}</strong><br>
                    ${step.explanation}
                </div>
            `;
            explanationDiv.style.display = 'block';
        }

        // Enable next button
        document.getElementById('next-btn').disabled = false;
    }

    // ==========================================
    // NAVIGATION
    // ==========================================

    function nextStep() {
        currentStep++;
        state.dayProgress[currentDay.day] = currentStep;
        saveState();

        if (currentStep >= currentDay.steps.length) {
            completeDay();
        } else {
            renderProgress();
            renderStep();
            window.scrollTo(0, 0);
        }
    }

    function completeDay() {
        if (!state.completedDays.includes(currentDay.day)) {
            state.completedDays.push(currentDay.day);
            state.xp += currentDay.xp;
            saveState();
            updateStats();
        }

        showReward(currentDay.xp, currentDay.icon);
    }

    // ==========================================
    // REWARD
    // ==========================================

    function showReward(xp, emoji) {
        document.getElementById('reward-emoji').textContent = emoji;
        document.getElementById('reward-xp').textContent = `+${xp} XP`;
        document.getElementById('reward-overlay').classList.add('active');
        createConfetti();
    }

    function closeReward() {
        document.getElementById('reward-overlay').classList.remove('active');
        goHome();
    }

    function createConfetti() {
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const pieces = [];
        const colors = ['#6366f1', '#f472b6', '#fbbf24', '#10b981'];

        for (let i = 0; i < 100; i++) {
            pieces.push({
                x: Math.random() * canvas.width,
                y: -20,
                size: Math.random() * 8 + 4,
                color: colors[Math.floor(Math.random() * colors.length)],
                speed: Math.random() * 3 + 2,
                angle: Math.random() * Math.PI * 2
            });
        }

        let frame = 0;
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            pieces.forEach(p => {
                p.y += p.speed;
                p.angle += 0.1;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle);
                ctx.fillStyle = p.color;
                ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                ctx.restore();
            });
            frame++;
            if (frame < 150) requestAnimationFrame(animate);
            else ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        animate();
    }

    // ==========================================
    // SAVE/LOAD
    // ==========================================

    function exportProgress() {
        const data = JSON.stringify(state, null, 2);
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `p5js_backup_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);

        const msg = document.getElementById('save-msg');
        msg.textContent = 'âœ… ë°±ì—… ì™„ë£Œ!';
        msg.classList.add('show');
        setTimeout(() => msg.classList.remove('show'), 3000);
    }

    function importProgress(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const imported = JSON.parse(e.target.result);
                state = { ...state, ...imported };
                saveState();
                updateStats();
                renderHome();

                const msg = document.getElementById('save-msg');
                msg.textContent = 'âœ… ë³µì› ì™„ë£Œ!';
                msg.classList.add('show');
                setTimeout(() => msg.classList.remove('show'), 3000);
            } catch (err) {
                alert('íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ì–´ìš”');
            }
        };
        reader.readAsText(file);
        event.target.value = '';
    }

    // Start
    document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
